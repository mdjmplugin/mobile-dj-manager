function mdjm_validate_payment_form(){var a=jQuery('input[type="radio"][name="mdjm_payment_amount"]:checked');if(0===a.length)return{msg:mdjm_vars.no_payment_amount};if("part_payment"===a.val()){var b=jQuery("#part-payment").val();if(!jQuery.isNumeric(b))return{type:"error",field:"part-payment",msg:mdjm_vars.no_payment_amount}}return mdjm_vars.require_privacy&&!jQuery("#mdjm-agree-privacy-policy").is(":checked")?{type:"error",field:"mdjm-agree-privacy-policy",msg:mdjm_vars.privacy_error}:mdjm_vars.require_terms&&!jQuery("#mdjm-agree-terms").is(":checked")?{type:"error",field:"mdjm-agree-terms",msg:mdjm_vars.terms_error}:{type:"success"}}function mdjm_load_gateway(a){jQuery(".mdjm-payment-ajax").show(),jQuery("#mdjm_payment_form_wrap").html('<img src="'+mdjm_vars.ajax_loader+'"/>');var b=mdjm_vars.ajaxurl;b+=b.indexOf("?")>0?"&":"?",b=b+"payment-mode="+a,jQuery.post(b,{action:"mdjm_load_gateway",mdjm_payment_mode:a},function(a){jQuery("#mdjm_payment_form_wrap").html(a),jQuery(".mdjm-no-js").hide(),jQuery(".mdjm-payment-ajax").hide()})}var mdjm_vars;jQuery(document).ready(function(a){var b=a(".mdjm_datepicker");if(b.length>0){var c=mdjm_vars.date_format,d=mdjm_vars.first_day;b.datepicker({dateFormat:c,altfield:"#_mdjm_event_date",altformat:"yy-mm-dd",firstday:d,changeyear:!0,changemonth:!0})}a(document).on("click",".mdjm-scroller",function(b){b.preventDefault();var c=a(this).attr("href");a("html, body").animate({scrollTop:a(c).offset().top},500)}),a("select#mdjm-gateway, input.mdjm-gateway").change(function(){var b=a("#mdjm-gateway option:selected, input.mdjm-gateway:checked").val();return"0"!==b&&(mdjm_load_gateway(b),!1)}),"1"===mdjm_vars.is_payment&&a("select#mdjm-gateway, input.mdjm-gateway").length&&setTimeout(function(){mdjm_load_gateway(mdjm_vars.default_gateway)},200),a(document.body).on("click","#mdjm-payment-part",function(){a("#mdjm-payment-custom").show("fast")}),a(document.body).on("click","#mdjm-payment-deposit, #mdjm-payment-balance",function(){a("#mdjm-payment-custom").hide("fast")}),a(document).on("click","#mdjm_payment_form #mdjm_payment_submit input[type=submit]",function(b){var c=document.getElementById("mdjm_payment_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mdjm_vars.payment_loading),a(this).prop("disabled",!0),a(this).after('<span class="mdjm-payment-ajax"><i class="mdjm-icon-spinner mdjm-icon-spin"></i></span>');var d=mdjm_validate_payment_form(c);"success"===d.type?(a(c).find(".mdjm-alert").hide("fast"),a(c).find(".error").removeClass("error"),a(c).submit()):(a(c).find(".mdjm-alert").show("fast"),a(c).find(".mdjm-alert").text(d.msg),d.field&&a("#"+d.field).addClass("error"),a(this).val(mdjm_vars.complete_payment),a(this).prop("disabled",!1))}}),a(document).on("click","#mdjm_playlist_form #playlist_entry_submit",function(b){var c=document.getElementById("mdjm_playlist_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mdjm_vars.submit_playlist_loading),a(this).prop("disabled",!0),a("#mdjm_playlist_form_fields").addClass("mdjm_mute"),a(this).after(' <span id="mdjm-loading" class="mdjm-loader"><img src="'+mdjm_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#mdjm_playlist_form"),e=a("#mdjm_playlist_form").serialize();d.find(".mdjm-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:mdjm_vars.ajaxurl,success:function(b){b.error?(d.find(".mdjm-alert-error").show("fast"),d.find(".mdjm-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(a("#mdjm_artist").val(""),a("#mdjm_song").val(""),a("#mdjm_notes").val(""),a("#mdjm_artist").focus(),a("#playlist-entries").hasClass("mdjm-hidden")&&a("#playlist-entries").removeClass("mdjm-hidden"),d.find(".mdjm-alert-success").show("fast").delay(3e3).hide("fast"),d.find(".mdjm-alert-success").html(mdjm_vars.playlist_updated),a("#playlist-entries").append(b.data.row_data),b.data.closed?window.location.href=mdjm_vars.playlist_page:(a(".song-count").text(b.data.songs),a(".playlist-length").text(b.data.length),0!==b.data.total&&a(".view_current_playlist").hasClass("mdjm-hidden")&&a(".view_current_playlist").removeClass("mdjm-hidden"))),a("#playlist_entry_submit").prop("disabled",!1),a("#mdjm_playlist_form_fields").find("#mdjm-loading").remove(),a("#playlist_entry_submit").val(mdjm_vars.submit_playlist),a("#mdjm_playlist_form_fields").removeClass("mdjm_mute")}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),a(document).on("click",".playlist-delete-entry",function(){var b=a(this).data("event"),c=a(this).data("entry"),d=".mdjm-playlist-entry-"+c,e={event_id:b,song_id:c,action:"mdjm_remove_playlist_entry"};a.ajax({type:"POST",dataType:"json",data:e,url:mdjm_vars.ajaxurl,beforeSend:function(){a("#playlist-entries").addClass("mdjm_mute"),a(d).addClass("mdjm_playlist_removing")},complete:function(){a("#playlist-entries").removeClass("mdjm_mute")},success:function(b){b.success&&(a(d).remove(),b.data.count>0?(a(".song-count").text(b.data.songs),a(".playlist-length").text(b.data.length)):(a("#playlist-entries").addClass("mdjm-hidden"),a(".view_current_playlist").hasClass("mdjm-hidden")||a(".view_current_playlist").addClass("mdjm-hidden")))}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}),a(document).on("click","#mdjm_guest_playlist_form #entry_guest_submit",function(b){var c=document.getElementById("mdjm_guest_playlist_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mdjm_vars.submit_playlist_loading),a(this).prop("disabled",!0),a("#mdjm_guest_playlist_form_fields").addClass("mdjm_mute"),a(this).after(' <span id="mdjm-loading" class="mdjm-loader"><img src="'+mdjm_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#mdjm_guest_playlist_form"),e=a("#mdjm_guest_playlist_form").serialize();d.find(".mdjm-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:mdjm_vars.ajaxurl,success:function(b){b.error?(d.find(".mdjm-alert-error").show("fast"),d.find(".mdjm-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(a(".mdjm_guest_name_field").is(":visible")&&a(".mdjm_guest_name_field").slideToggle("fast"),a("#mdjm-guest-artist").val(""),a("#mdjm-guest-song").val(""),a("#mdjm-guest-artist").focus(),a("#guest-playlist-entries").hasClass("mdjm-hidden")&&a("#guest-playlist-entries").removeClass("mdjm-hidden"),d.find(".mdjm-alert-success").show("fast").delay(3e3).hide("fast"),d.find(".mdjm-alert-success").html(mdjm_vars.playlist_updated),a("#guest-playlist-entries").append(b.entry),b.closed&&(a("#mdjm-guest-playlist-input-fields").addClass("mdjm-hidden"),a("#guest-playlist-entries").append('<div class="mdjm-alert mdjm-alert-info">'+mdjm_vars.guest_playlist_closed+"</div>"))),a("#entry_guest_submit").prop("disabled",!1),a("#mdjm_guest_playlist_form_fields").find("#mdjm-loading").remove(),a("#entry_guest_submit").val(mdjm_vars.submit_guest_playlist),a("#mdjm_guest_playlist_form_fields").removeClass("mdjm_mute")}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),a(document).on("click",".guest-playlist-delete-entry",function(){var b=a(this).data("event"),c=a(this).data("entry"),d=".mdjm-playlist-entry-"+c,e={event_id:b,song_id:c,action:"mdjm_remove_guest_playlist_entry"};a.ajax({type:"POST",dataType:"json",data:e,url:mdjm_vars.ajaxurl,beforeSend:function(){a("#guest-playlist-entries").addClass("mdjm_mute"),a(d).addClass("mdjm_playlist_removing")},complete:function(){a("#guest-playlist-entries").removeClass("mdjm_mute")},success:function(b){b.success&&a(d).remove()}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}),a(document).on("click","#mdjm_client_profile_form #update_profile_submit",function(b){var c=document.getElementById("mdjm_client_profile_form");if("function"!=typeof c.checkValidity||!1!==c.checkValidity()){b.preventDefault(),a(this).val(mdjm_vars.submit_profile_loading),a(this).prop("disabled",!0),a("#mdjm_client_profile_form_fields").addClass("mdjm_mute"),a(this).after(' <span id="mdjm-loading" class="mdjm-loader"><img src="'+mdjm_vars.ajax_loader+'" /></span>'),a("input").removeClass("error");var d=a("#mdjm_client_profile_form"),e=a("#mdjm_client_profile_form").serialize();d.find(".mdjm-alert").hide("fast"),a.ajax({type:"POST",dataType:"json",data:e,url:mdjm_vars.ajaxurl,success:function(b){b.error?(d.find(".mdjm-alert-error").show("fast"),d.find(".mdjm-alert-error").html(b.error),d.find("#"+b.field).addClass("error"),d.find("#"+b.field).focus()):(d.find(".mdjm-alert-success").show("fast"),d.find(".mdjm-alert-success").html(mdjm_vars.profile_updated),a("html, body").animate({scrollTop:a(".mdjm-alert-success").offset().top},500)),b.password?window.location.href=mdjm_vars.profile_page:(a("#update_profile_submit").prop("disabled",!1),a("#mdjm_client_profile_form_fields").find("#mdjm-loading").remove(),a("#update_profile_submit").val(mdjm_vars.submit_client_profile),a("#mdjm_client_profile_form_fields").removeClass("mdjm_mute"))}}).fail(function(a){window.console&&window.console.log&&console.log(a)})}}),mdjm_vars.availability_ajax&&a("#mdjm-availability-check").submit(function(b){if(!a("#availability_check_date").val())return!1;!!b.preventDefault&&b.preventDefault();var c=a("#availability_check_date").val(),d=mdjm_vars.rest_url;d+="availability/",d+="?date="+c,a.ajax({type:"GET",dataType:"json",url:d,beforeSend:function(){a('input[type="submit"]').hide(),a("#pleasewait").show()},success:function(b){var d=b.data.availability;"available"===d.response?("text"!==mdjm_vars.available_redirect?window.location.href=mdjm_vars.available_redirect+"mdjm_avail_date="+c:(a("#mdjm-availability-result").replaceWith('<div id="mdjm-availability-result">'+d.message+"</div>"),a("#mdjm-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1)):("text"!==mdjm_vars.unavailable_redirect?window.location.href=mdjm_vars.unavailable_redirect+"mdjm_avail_date="+c:(a("#mdjm-availability-result").replaceWith('<div id="mdjm-availability-result">'+d.message+"</div>"),a("#mdjm-submit-availability").fadeTo("slow",1),a("#pleasewait").hide()),a('input[type="submit"]').prop("disabled",!1))}})}),a("#mdjm-availability-check").validate({rules:{"mdjm-availability-datepicker":{required:!0}},messages:{"mdjm-availability-datepicker":{required:mdjm_vars.required_date_message}},errorClass:"mdjm_form_error",validClass:"mdjm_form_valid"})});